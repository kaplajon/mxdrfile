<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>mxdrfile by kaplajon</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>mxdrfile</h1>
        <p>mxdrfile is a set of wrapper functions that enables reading and writing Gromacs .xtc and .trr trajectory files in Matlab. The wrapper functions make direct use of the xdrfile library from Gromacs through the intrinsic loadlibrary function in Matlab.</p>
        <p class="view"><a href="https://github.com/kaplajon/mxdrfile">View the Project on GitHub <small>kaplajon/mxdrfile</small></a></p>
        <ul>
          <li><a href="https://github.com/kaplajon/mxdrfile/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/kaplajon/mxdrfile/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/kaplajon/mxdrfile">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a name="about-mxdrfile" class="anchor" href="#about-mxdrfile"><span class="octicon octicon-link"></span></a>About mxdrfile</h1>

<p>The mxdrfile wrapper functions were created with the aim of improving the abilities of fast trajectory analysis in Matlab. The library enables reading and writing of .xtc and .trr trajectory files through the use of the original <a href="http://www.gromacs.org/Developer_Zone/Programming_Guide/XTC_Library">xdrfile library</a> from the Gromacs team.</p>

<p>Both the latest version of the  xdrfile library and mxdrfile are open source and released under a BSD license.</p>

<h1>
<a name="using-the-library-with-matlab" class="anchor" href="#using-the-library-with-matlab"><span class="octicon octicon-link"></span></a>Using the Library with Matlab</h1>

<p>INSTALLATION:</p>

<blockquote>
<p>&gt; cd my/path/to/mxdrfile</p>
<p>&gt; make</p>
</blockquote>

<p>Pay attention to any errors in the make procedure. If needed install required
libraries and/or consult the libxdrfile documentation.</p>

<blockquote>
<p>&gt; make test</p>
</blockquote>

<p>If all went ok, the library can be loaded in Matlab with:</p>

<blockquote>
<p>&gt; loadmxdrfile</p>
</blockquote>

<p>or</p>

<blockquote>
<p>&gt; addpath(genpath(fullpath('my','path','to','mxdrfile','mxdrfunctions')))</p>
<p>&gt; loadlibrary('libxdrfile',@fileheaders)</p>
</blockquote>

<h3>
<a name="testing-the-library" class="anchor" href="#testing-the-library"><span class="octicon octicon-link"></span></a>Testing the Library</h3>

<p>The library read and write functions can be tested by running the included test scripts test_trr.m
and test_xtc.m in Matlab after completing the above install procedure.</p>

<h1>
<a name="theclass" class="anchor" href="#theclass"><span class="octicon octicon-link"></span></a>The mxdrfile Class</h1>
<p>--&gt; FILE: @mxdrfile/mxdrfile.m</p>

<p>USAGE: trj=mxdrfile(trajfile [,indexfile])</p>

<ul>
    <li>trajfile - (str) Trajectory filename with .trr or .xtc extension</li>
    <li>indexfile - (str) OPTIONAL: Gromacs indexfile in .ndx format</li>
</ul>
<h2>
<a name="class-properties" class="anchor" href="#class-properties"><span class="octicon octicon-link"></span></a>Class Properties</h2>
<ul>
    <li>fname - (str) Trajectory filename</li>
    <li>ftype - (str) Trajectory filetype (by extension)</li>
    <li>fhandle - (1x1 lib.pointer) File handle for the open trajfile</li>
    <li>natoms - (int32) Number of atoms in trajectory</li>
    <li>status - (int32) Status of trajectory processing, 0=OK</li>
    <li>step - (int32) Trajectory step number</li>
    <li>time - (int32) Time in ps</li>
    <li>lam - (int32) Lambda</li>
    <li>box - (1x1 lib.pointer) box as a 3x3 matrix: value [3x3 single]</li>
    <li>x - (1x1 lib.pointer) Coordinates: value [3xnatoms single]</li>
    <li>v - (1x1 lib.pointer) Velocities (trr only): value [3xnatoms single]</li>
    <li>f - (1x1 lib.pointer) Forces (trr only):  value [3xnatoms single]</li>
    <li>prec - (int32) Precision of xtc files (default 1000)</li>
    <li>ndx - (1x1 struct) If indexfile is given field names are ndx groups: [nx1 int32]</li>
</ul>
<h2>
<a name="class-methods" class="anchor" href="#class-methods"><span class="octicon octicon-link"></span></a>Class Methods</h2>
<ul>
    <li>read - read next frame in trajectory</li>
    <li>delete - Close trajectory file when the class object is destroyed</li>
</ul>

<h1>
<a name="the-wrapper-functions" class="anchor" href="#the-wrapper-functions"><span class="octicon octicon-link"></span></a>The Wrapper Functions</h1>
<h2>
<a name="open-and-close" class="anchor" href="#open-and-close"><span class="octicon octicon-link"></span></a>Open and Close</h2>

<p>--&gt; FILE: inittraj.m</p>

<p>USAGE: [status,initstruct]=inittraj(fname,action)</p>

<ul>
<li>fname - (str) Filename of .xtc or .trr file</li>
<li>action - (str) 'r' or 'w' for read or write access. WARNING! 'w' will overwrite fname!!</li>
<li>status - (int32)</li>
<li>initstruct:

<ul>
<li>fhandle - (lib.pointer) XDR file handle</li>
<li>natoms - (int32) Number of atoms in trajectory</li>
</ul>
</li>
</ul><p>--&gt; FILE: closetraj.m</p>

<p>USAGE: status = closetraj(initstruct)</p>

<h2>
<a name="read" class="anchor" href="#read"><span class="octicon octicon-link"></span></a>Read</h2>

<p>--&gt; FILE: read_xtc.m</p>

<p>USAGE: [rstatus,trajstruct]=read_xtc(initstruct)</p>

<ul>
<li>status - int32</li>
<li>trajstruct:

<ul>
<li>step - (int32) timestep</li>
<li>time - (single) time in ps</li>
<li>box - (singlePtr) Box as a 3x3 array</li>
<li>x - (singlePtr) Coordinates as an 3xnatoms array</li>
<li>natoms - (int32) Number of atoms in trajectory</li>
<li>prec - (single) Precision of XTC file</li>
</ul>
</li>
</ul><p>--&gt; FILE: read_trr.m</p>

<p>USAGE: [rstatus,trajstruct]=read_xtc(initstruct)</p>

<ul>
<li>trajstruct:

<ul>
<li>step - (int32) timestep</li>
<li>time - (single) time in ps</li>
<li>lam - (single) lambda</li>
<li>box - (singlePtr) Box as a 3x3 array</li>
<li>x - (singlePtr) Coordinates as a 3xnatoms array</li>
<li>v - (singlePtr) Velocities as a 3xnatoms array</li>
<li>f - (singlePtr) Forces as a 3xnatoms array</li>
<li>natoms - (int32) Number of atoms in trajectory</li>
<li>prec - (single(1000.)) default precision for writing xtc</li>
</ul>
</li>
</ul><h2>
<a name="write" class="anchor" href="#write"><span class="octicon octicon-link"></span></a>Write</h2>

<p>--&gt; FILE: write_xtc.m</p>

<p>USAGE: wstatus=write_xtc(initstruct, trajstruct)</p>

<ul>
<li>wstatus - (int32)</li>
<li>initstruct.fhandle - filehandle with writeaccess</li>
<li>trajstruct:

<ul>
<li>step - (int32) timestep</li>
<li>time - (single) time in ps</li>
<li>box - (singlePtr) Box as a 3x3 array</li>
<li>x - (singlePtr) Coordinates as an 3xnatoms array</li>
<li>natoms - (int32) Number of atoms in trajectory</li>
<li>prec - (single) Precision of XTC file</li>
</ul>
</li>
</ul><p>--&gt; FILE: write_trr.m</p>

<p>USAGE: wstatus=write_trr(initstruct, trajstruct)</p>

<ul>
<li>wstatus - (int32)</li>
<li>initstruct.fhandle - filehandle with writeaccess</li>
<li>trajstruct:

<ul>
<li>step - (int32) timestep</li>
<li>time - (single) time in ps</li>
<li>lam - (single) lambda</li>
<li>box - (singlePtr) Box as a 3x3 array</li>
<li>x - (singlePtr) Coordinates as a 3xnatoms array</li>
<li>v - (singlePtr) Velocities as a 3xnatoms array</li>
<li>f - (singlePtr) Forces as a 3xnatoms array</li>
<li>natoms - (int32) Number of atoms in trajectory</li>
</ul>
</li>
</ul><h2>
<a name="helpers" class="anchor" href="#helpers"><span class="octicon octicon-link"></span></a>Helpers</h2>

<p>--&gt; FILE: catch_xdr_errors.m</p>

<p>USAGE: catch_xdr_errors(status)</p>

<ul>
<li>status - int32</li>
</ul><p>--&gt; FILE: read_xtc_natoms.m</p>

<p>USAGE: [status,natoms]=read_xtc_natoms(fname)</p>

<ul>
<li>fname - (str) Filename with .xtc extension</li>
<li>status - int32</li>
<li>natoms - int32</li>
</ul>
<p>--&gt; FILE: read_trr_natoms.m</p>

<p>USAGE: [status,natoms]=read_trr_natoms(fname)</p>

<ul>
<li>fname - (str) Filename with .trr extension</li>
<li>status - int32</li>
<li>natoms - int32</li>
</ul>
<p>--&gt; FILE: read_ndx.m</p>

<p>USAGE: ndx=read_ndx(ndxfile)</p>

<ul>
<li>ndx - (1x1 struct) Field names are ndx-groups [nx1 int32]</li>
<li>ndxfile - (str) Filename with .ndx extension</li>
</ul>
      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/kaplajon">kaplajon</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
